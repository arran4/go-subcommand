// Code generated by github.com/arran4/go-subcommand/cmd/gosubc. DO NOT EDIT.

package main

import (
	"flag"
	"testing"
	{{- $hasDuration := false }}
	{{- range .Parameters}}
	{{- if eq .Type "time.Duration" }}
	{{- $hasDuration = true }}
	{{- end }}
	{{- end }}
	{{- if $hasDuration }}
	"time"
	{{- end }}
)

func Test{{.SubCommandStructName}}_Execute(t *testing.T) {
	{{if .Parent}}
	parent := &{{.Parent.SubCommandStructName}}{}
	cmd := parent.New{{.SubCommandStructName}}()
	{{else}}
	parent := &RootCmd{
		FlagSet: flag.NewFlagSet("root", flag.ContinueOnError),
		Commands: make(map[string]Cmd),
	}
	cmd := parent.New{{.SubCommandStructName}}()
	{{end}}

	called := false
	cmd.CommandAction = func(c *{{.SubCommandStructName}}) error {
		called = true
		return nil
	}

	args := []string{}
	{{- range .Parameters}}
	{{- $param := . }}
	{{- if .IsPositional}}
		{{- if .IsVarArg}}
			{{- if gt .VarArgMin 0}}
				{{- range until .VarArgMin}}
					{{- if eq $param.Type "string"}}
					args = append(args, "test")
					{{- else if eq $param.Type "int"}}
					args = append(args, "1")
					{{- else if eq $param.Type "bool"}}
					args = append(args, "true")
					{{- else if eq $param.Type "time.Duration"}}
					args = append(args, "1s")
					{{- end}}
				{{- end}}
			{{- end}}
		{{- else}}
			{{- if eq .Type "string"}}
			args = append(args, "test")
			{{- else if eq .Type "int"}}
			args = append(args, "1")
			{{- else if eq .Type "bool"}}
			args = append(args, "true")
			{{- else if eq .Type "time.Duration"}}
			args = append(args, "1s")
			{{- end}}
		{{- end}}
	{{- end}}
	{{- end}}

	err := cmd.Execute(args)
	if err != nil {
		t.Errorf("Unexpected error: %v", err)
	}
	if !called {
		t.Error("CommandAction was not called")
	}
}
